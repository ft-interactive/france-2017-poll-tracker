{% extends "layout.html" %}

{% block article_body %}

<section class="button-navigation">
  <a href="#polls" class="navigation-item">
    Polls
  </a>
  <a href="#results" class="navigation-item">
    Results
  </a>
  <a href="#profiles" class="navigation-item">
    Profiles
  </a>
</section>

<section class="candidates">
  <h2 class="candidates--heading">The candidates</h2>

  <ul class="candidates--grid">
  {% set latestPoll = data.polls.data | sort(true, false, 'date') | first %}
  {% for candidate in data.candidates %}
    {% set candidateslug = (candidate.name.normalize('NFD') | replace(r/[\u0300-\u036f]/g, '') | replace(r/^[\w-]+\s/, '') | replace(r/\s/g, '') | lower) + '1' %}
    <li class="candidates--candidate candidates--candidate__{{candidate.name}}">
      <img class="candidates--profile-image" src="images/FE--{{candidate.name | replace(r/^[\w-ç]+\s/, '') | replace(r/\s/g, '-')}}.png" />
      <h2 class="candidates--name">{{candidate.name}}</h2>
      <h3 class="candidates--polling-numbers">Polling at {{latestPoll[candidateslug]}}%</h3>
      <p>{{candidate.copy | safe}}</p>
      <a href="{{candidate.linkurl}}" class="candidates--full-profile-button">Full profile</a>
    </li>
  {% endfor %}
  </ul>
</section>

<section class="polls">
  <p>
    {{polls.introText}}
  </p>

  <figure class="polls--current-state">
    <!-- I have no idea how the data looks on this -->
  </figure>

  <figure class="polls--scenario-1">
    <!-- I have no idea how the data looks on this -->
  </figure>

  <figure class="polls--scenario-2">
    <!-- I have no idea how the data looks on this -->
  </figure>
</section>

<section>
  <h2>The data</h2>
  <table>
    <thead>
      <tr>
        <td>Date</td>
        <td>Pollster</td>
        {% for candidate in data.candidates %}
        <td>{{ candidate.name.last }}</td>
        {% endfor %}
        <td>Sample*</td>
      </tr>
    </thead>
    <tbody>
      {% for poll in data.polls %}
      <tr>
        <td>{{ poll.start }}–{{ poll.end }}</td>
        <td>{{ poll.pollster }}</td>
        {% for candidate in data.candidates %}
        <td>{{ poll.candidate[candidate.key] }}</td>
        {% endfor %}
        <td>{{ poll.sample.size }} {{ poll.sample.type }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</section>

{% endblock %}
